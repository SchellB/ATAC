# working directory
wd <- getwd()
# ATACseq normalized counts
library(readr)
library(dplyr)
library(tibble)
ATAC <- read_csv2(paste0(wd,"/Results/Normalized.Counts.csv"))
data <- ATAC %>% column_to_rownames("...1")
# ATACseq DEG loading
load("ATAC.Rdata")
library(pathfindR)
pathenrich <- function(data,table, gene_sets="KEGG",
p_val_threshold=0.01,
adj_method="BH", wd, name){
tab <- table %>% select(c(genes, logFC, P.Value))
pdf(file = paste0(wd,"/Output/pathenrich_",gene_sets,"_",name,".pdf"))
output <- run_pathfindR(tab, gene_sets = gene_sets,
p_val_threshold =p_val_threshold,
adj_method=adj_method)
clustered <- cluster_enriched_terms(output,
plot_hmap=TRUE,
plot_dend=TRUE)
term_gene_heatmap(output)
term_gene_graph(output)
UpSet_plot(output)
score_terms(output, as.matrix(data))
dev.off()
write.csv2(output,file=paste0(wd,"/Results/pathenrich_",gene_sets,"_",name,".csv"), row.names = FALSE)
}
## HR vs HD
pathenrich(data=data, table = HRvsHD_ATAC, name="HRvsHD", gene_sets="GO-BP",wd=wd)
setwd("D:/Berenice/ATAC")
# working directory
wd <- getwd()
ATAC <- read_csv2(paste0(wd,"/Results/Normalized.Counts.csv"))
data <- ATAC %>% column_to_rownames("...1")
# ATACseq DEG loading
load("ATAC.Rdata")
library(pathfindR)
pathenrich <- function(data,table, gene_sets="KEGG",
p_val_threshold=0.01,
adj_method="BH", wd, name){
tab <- table %>% select(c(genes, logFC, P.Value))
pdf(file = paste0(wd,"/Output/pathenrich_",gene_sets,"_",name,".pdf"))
output <- run_pathfindR(tab, gene_sets = gene_sets,
p_val_threshold =p_val_threshold,
adj_method=adj_method)
clustered <- cluster_enriched_terms(output,
plot_hmap=TRUE,
plot_dend=TRUE)
term_gene_heatmap(output)
term_gene_graph(output)
UpSet_plot(output)
score_terms(output, as.matrix(data))
dev.off()
write.csv2(output,file=paste0(wd,"/Results/pathenrich_",gene_sets,"_",name,".csv"), row.names = FALSE)
}
## HR vs HD
pathenrich(data=data, table = HRvsHD_ATAC, name="HRvsHD", gene_sets="GO-BP",wd=wd)
## HR vs HD
pathenrich(data=data, table = HRvsHD_ATAC, name="HRvsHD", gene_sets="GO-CC",wd=wd)
## AML vs HD
pathenrich(data=data, table = AMLvsHD_ATAC, name="AMLvsHD", gene_sets="GO-BP",wd=wd)
## AML vs HD
pathenrich(data=data, table = AMLvsHD_ATAC, name="AMLvsHD", gene_sets="GO-CC",wd=wd)
## HR vs AML
pathenrich(data=data, table = HRvsAML_ATAC, name="HRvsAML", gene_sets="GO-CC",wd=wd)
## HR&AML vs HD
pathenrich(data=data, table = HR_AMLvsHD_ATAC, name="HR_AMLvsHD", gene_sets="GO-CC",wd=wd)
library(limma)tab <- getGeneKEGGLinks(species="hsa")
library(limma)
tab <- getGeneKEGGLinks(species="hsa")
tab$Symbol <- mapIds(org.Hs.eg.db, tab$GeneID,
column="SYMBOL", keytype="ENTREZID")
library("AnnotationDbi")
library("org.Mm.eg.db")
library("clusterProfiler")
install.packages("org.Hs.eg.db")
install.packages("org.Hs.eg.db")
install.packages("ClusterProfiler")
BiocManager::install(ClusterProfiler)
BiocManager::install("ClusterProfiler")
library("ClusterProfiler")
tab$Symbol <- mapIds(org.Hs.eg.db, tab$GeneID,
column="SYMBOL", keytype="ENTREZID")
library("org.Hs.db")
library("org.Hs.eg.db")
tab$Symbol <- mapIds(org.Hs.eg.db, tab$GeneID,
column="SYMBOL", keytype="ENTREZID")
View(tab)
head(getKEGGPathwayNames(species="hsa")
head(getKEGGPathwayNames(species="hsa"))
library(KEGGREST)
install.packages("KEGGREST")
install.packages("KEGGREST")
library(KEGGREST)
head(getKEGGPathwayNames(species="hsa"))
library(org.Hs.eg.db)
library(tidyverse)
head(getKEGGPathwayNames(species="hsa"))
hsa_path_eg  <- keggLink("pathway", "hsa") %>%
tibble(pathway = ., eg = sub("hsa:", "", names(.)))
hsa_path_eg  <- keggLink("pathway", "hsa") %>% tibble(pathway = ., eg = sub("hsa:", "", names(.)))
hsa_kegg_anno <- hsa_path_eg %>%
mutate(
symbol = mapIds(org.Hs.eg.db, eg, "SYMBOL", "ENTREZID"),
ensembl = mapIds(org.Hs.eg.db, eg, "ENSEMBL", "ENTREZID")
)
hsa_kegg_anno
hsa_pathways <- keggList("pathway", "hsa") %>%
tibble(pathway = names(.), description = .)
hsa_pathways
View(hsa_pathways)
View(hsa_path_eg)
View(hsa_kegg_anno)
genes <- hsa_kegg_anno[pathway=="path::hsa05221",]
genes <- hsa_kegg_anno[hsa_kegg_anno$pathway=="path::hsa05221",]
genes <- hsa_kegg_anno[hsa_kegg_anno$pathway=="path:hsa05221",]
View(genes)
genes$symbol
unlist(genes$symbol)
write.csv2(genes)
write.csv2(genes, file="AML.csv")
genes <- hsa_kegg_anno[hsa_kegg_anno$pathway=="path:hsa04650",]
write.csv2(genes, file="NKcytotox.csv")
